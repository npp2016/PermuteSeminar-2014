<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Week 4 Notes and Exercises</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>Week 4 Notes and Exercises</h1>

<p>For this week, we read Chapter 8 in Efron and Tibshirani, and notes on bootstrapping dependent data (Steigerwald; posted to GitHub and on Blackboard).  This chapter provides an overview of bootstrapping procedues for more complicated data structures than the one-sample model, such as time-dependent data or otherwise non-IID data.</p>

<h2>In-class discussion:</h2>

<h2>Examples from Efron and Tibshirani:</h2>

<p><strong>(8.3) The two-sample problem</strong></p>

<p>Sixteen mice were randomly assigned to a treatment group (n=7) or a control group (n=9), and their survival times following a surgery were recorded.  Let \( z \) indicate the treatment observations, and \( y \) indicate the control observations.</p>

<pre><code class="r">z &lt;- c(94, 197, 16, 38, 99, 141, 23)
y &lt;- c(52, 104, 146, 10, 51, 30, 40, 27, 46)
</code></pre>

<p>Together, we will consider the observed data as a vector \( x=(z,y). \) and a probability model \( P=(F,G) \) where \( F \) represents the unknown probability distrbution underlying observed treatment data \( z \), and \( G \) indicates the unknown probability model from which observed control data \( y \) were drawn.  We wish to estimate \( P \).  The estimate of P is \( \hat{P}=(\hat{F}, \hat{G}) \).  A bootstrap sample \( x^{*} \) is taken as \( \hat{P} \rightarrow x \).  </p>

<pre><code class="r">theta = mean(z) - mean(y)
theta
</code></pre>

<pre><code>## [1] 30.63
</code></pre>

<p>The difference of the treatment and control means \( \hat{\theta}= 30.63 \).  </p>

<p>We can also take a bootstrap estimate, and use that to estimate standard error:</p>

<pre><code class="r">meanz &lt;- NULL
meany &lt;- NULL
thetabs &lt;- NULL
for (i in 1:1400) {
    bootz = sample(z, 7, replace = TRUE)
    booty = sample(y, 9, replace = TRUE)
    meanz = append(meanz, mean(bootz))
    meany = append(meany, mean(booty))
    thetabs = append(thetabs, mean(bootz) - mean(booty))
}

se &lt;- sqrt(sum((thetabs - theta)^2)/1399)
</code></pre>

<p>The bootstrap estimate of standard error for \( \hat{\theta} \) is</p>

<pre><code class="r">se
</code></pre>

<pre><code>## [1] 26.8
</code></pre>

<p>so \( \hat{\theta} \) is only</p>

<pre><code class="r">mean(thetabs)/se
</code></pre>

<pre><code>## [1] 1.169
</code></pre>

<p>standard errors above zero.  </p>

<pre><code class="r">require(ggplot2)
</code></pre>

<pre><code>## Loading required package: ggplot2
</code></pre>

<pre><code class="r">seplot &lt;- data.frame(thetabs)
names(seplot) = &quot;SE&quot;
mean = mean(seplot$SE)
ggplot(seplot, aes(SE)) + geom_histogram(fill = &quot;black&quot;, binwidth = 10) + theme_classic() + 
    geom_vline(xintercept = mean, col = &quot;steelblue&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6"/> </p>

<p><strong>(8.5 Lutenizing hormone)</strong></p>

<p>This data set shows the levels of a lutenizing hormone for 48 consecutive 10-minute intervals in one woman.  These data are not a random sample from a distribution; they instead are an example of a time series (see the figure below). </p>

<pre><code class="r">lh &lt;- read.csv(&quot;hormone_data.csv&quot;, header = TRUE)
require(ggplot2)
ggplot(lh, aes(period, level)) + geom_line(col = &quot;black&quot;) + theme_classic() + 
    labs(title = &quot;Lutenizing Hormone Data&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-7"/> </p>

<p>We will assume that these data follow a first order autoregressive scheme.  First, we will define the centered measurements \( z_{t}=y_{t}-\mu \), where all \( z_{t} \) have expectation \( 0 \).</p>

<p>Each \( z_{t} \) is a linear combination of the previous value \( z_{t-1} \) and an independent disturbance term \( \epsilon_{t} \), where the \( \epsilon_{t} \) is assumed to be a random sample from an unknown distribution \( F \) with expectation \( 0 \).</p>

<p>\[ F \rightarrow (\epsilon_{U}, \epsilon_{U+1}, \epsilon_{U+2}, \cdots, \epsilon_{V})  
[E_{F}(\epsilon)=0] \]</p>

<p>The dates \( U \) and \( V \) are the beginning and end of the time period; \( U=2 \); \( V=48 \).  We define \( z_{u} = \beta z_{U-1} + \epsilon_{U} \), and \( z_{U-1} = z_{1} \). \( \beta \) is an unknown parameter varying between \( -1 \) and \( 1 \). </p>

<p>We can estimate the value of \( \beta \) using a least squares approach.  First, we estimate the expectation \( \mu \) to be the observed average \( \bar{y} \), so that \( z_{t} = y_{t} - \bar{y} \).</p>

<pre><code class="r">lhc &lt;- lh$level - mean(lh$level)
lh$c = lhc  #defining the new z(t) as y(t) - mean(y) and adding it to the existing data frame
ggplot(lh, aes(period, c)) + geom_line(col = &quot;black&quot;) + theme_classic() + labs(title = &quot;Centered Data&quot;)  #plot z
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"/> </p>

<p>We expect that \( RSE(b) \) has expectation \( E(RSE(b)) \) and is minimized when \( b = \beta \).  We can calculate \( RSE(b) \) asa function of \( b \), and choose the value that minimizes this function to serve as our estimate of \( \beta \).  Remember that \( \beta \) varies between \( -1 \) and \( 1 \).</p>

<pre><code class="r">Z = data.frame(t1 = c(lh$c[1:47]), t2 = c(lh$c[2:48]))
optimize(f = )  #I&#39;m stuck on how to actually calculate the least-squares estimate of beta.
</code></pre>

<pre><code>## Error: &#39;interval&#39; is missing
</code></pre>

<p>We can use bootstrap to see how accurate our estimate of \( \hat{\beta} \) is.  </p>

<pre><code class="r">mu = mean(lh$level)
beta = 0.586  #This is the beta estimate given in Efron and Tibshirani
e = (Z$t2) - beta * (Z$t1)  #create the estimated value of espilon for each t
# I&#39;m not sure where to go from here
</code></pre>

<p><strong>(8.6) The moving blocks bootstrap</strong></p>

<p>This is a different approach to bootstrapping time series data that is closer to the approach used in one-sample problems than what is used above.  To generate a bootstrapped version of an observed time series, we choose a particular block length and consider all possible contiguous blocks of this length in the observed data.  We sample these blocks with replacement, instead of sampling single values with replacement.  This preserves some of the autocorrelation in the bootstrapped dataset.  The sampled blocks are pasted together to form a bootstrap time series, so we only want to sample as many blocks as we need to recreate a series approximately the same length as the observed series.  (So if the block length is \( l \), we sample \( k \) blocks where \( n \approx k \cdot l \). </p>

</body>

</html>

